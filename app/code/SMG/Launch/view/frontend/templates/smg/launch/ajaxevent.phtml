<div id="ajax_event">
<?php

$helper = $block->getHelper();
$smghelper = $this->helper('SMG\Launch\Helper\Data');

$updateditems = $smghelper->getCheckoutSession()->getUpdateqty();

if ($updateditems) :
    foreach($updateditems as $pro){ ?>
        <?php if ($pro["quantity"] != $pro["previousQuantity"]):?>
        <script>

            window.dtmData.events.push({
                name: 'cartUpdate',
                product: {
					id: '<?php echo $block->escapeHtml($pro["id"]);?>',
					name: '<?php $p_name = $pro["name"]; echo $block->escapeHtml(str_replace("â„¢","",$p_name)); ?>',
					currency: '<?php echo $block->escapeHtml($block->getCurrencyCode());?>',
					unitPrice: <?php echo $block->escapeHtml($pro["unitPrice"]);?>,
					sku: '<?php echo $block->escapeHtml($pro["sku"]);?>',
                    <?php if (!empty($pro['drupalproductid'])): ?>
                    drupalproductid:  '<?php echo $block->escapeHtml($pro['drupalproductid']) ?>',
                    <?php endif; ?>
					quantity: <?php echo $block->escapeHtml($pro["quantity"]);?>,
					previousQuantity: <?php echo $block->escapeHtml($pro["previousQuantity"]);?>
                }

            });

        </script>
        <?php endif; ?>
    <?php }
    $smghelper->getCheckoutSession()->unsUpdateqty();
endif; ?>
</div>